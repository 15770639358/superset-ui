(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{1603:function(module,exports,__webpack_require__){var api=__webpack_require__(270),content=__webpack_require__(1604);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1},exported=(api(content,options),content.locals?content.locals:{});module.exports=exported},1604:function(module,exports,__webpack_require__){(exports=__webpack_require__(271)(!1)).push([module.i,'/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * "License"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n.superset-legacy-chart-horizon {\n  overflow: auto;\n  position: relative;\n}\n\n.superset-legacy-chart-horizon .horizon-row {\n  border-bottom: solid 1px #ddd;\n  border-top: 0px;\n  padding: 0px;\n  margin: 0px;\n}\n\n.superset-legacy-chart-horizon .horizon-row span.title {\n  position: absolute;\n  color: #333;\n  font-size: 0.8em;\n  margin: 0;\n  text-shadow: 1px 1px rgba(255, 255, 255, 0.75);\n}\n',""]),module.exports=exports},2139:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(40);var react=__webpack_require__(0),react_default=__webpack_require__.n(react),prop_types=__webpack_require__(4),prop_types_default=__webpack_require__.n(prop_types),extent=__webpack_require__(257),linear=__webpack_require__(35);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const DEFAULT_COLORS=["#313695","#4575b4","#74add1","#abd9e9","#fee090","#fdae61","#f46d43","#d73027"],propTypes={className:prop_types_default.a.string,width:prop_types_default.a.number,height:prop_types_default.a.number,data:prop_types_default.a.arrayOf(prop_types_default.a.shape({y:prop_types_default.a.number})).isRequired,bands:prop_types_default.a.number,colors:prop_types_default.a.arrayOf(prop_types_default.a.string),colorScale:prop_types_default.a.string,mode:prop_types_default.a.string,offsetX:prop_types_default.a.number,title:prop_types_default.a.string,yDomain:prop_types_default.a.arrayOf(prop_types_default.a.number)},defaultProps={className:"",width:800,height:20,bands:DEFAULT_COLORS.length>>1,colors:DEFAULT_COLORS,colorScale:"series",mode:"offset",offsetX:0,title:"",yDomain:void 0};class HorizonRow_HorizonRow extends react_default.a.PureComponent{componentDidMount(){this.drawChart()}componentDidUpdate(){this.drawChart()}componentWillUnmount(){this.canvas=null}drawChart(){if(this.canvas){const{data:rawData,yDomain:yDomain,width:width,height:height,bands:bands,colors:colors,colorScale:colorScale,offsetX:offsetX,mode:mode}=this.props,data="change"===colorScale?rawData.map(d=>function _objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null!=arguments[i]?arguments[i]:{},i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}));return target}({},d,{y:d.y-rawData[0].y})):rawData,context=this.canvas.getContext("2d");context.imageSmoothingEnabled=!1,context.clearRect(0,0,width,height),context.setTransform(1,0,0,1,0,0),context.translate(.5,.5);const step=width/data.length,startIndex=Math.floor(Math.max(0,-offsetX/step)),endIndex=Math.floor(Math.min(data.length,startIndex+width/step));if(startIndex>data.length)return;const[min,max]=yDomain||Object(extent.a)(data,d=>d.y),y=Object(linear.a)().domain([0,Math.max(-min,max)]).range([0,height]);let value,bExtents,hasNegative=!1;for(let b=0;b<bands;b+=1){context.fillStyle=colors[bands+b],bExtents=(b+1-bands)*height,y.range([bands*height+bExtents,bExtents]);for(let i=startIndex;i<endIndex;i++)value=data[i].y,0>=value?hasNegative=!0:void 0!==value&&context.fillRect(offsetX+i*step,y(value),step+1,y(0)-y(value))}if(hasNegative){"offset"===mode&&(context.translate(0,height),context.scale(1,-1));for(let b=0;b<bands;b++){context.fillStyle=colors[bands-b-1],bExtents=(b+1-bands)*height,y.range([bands*height+bExtents,bExtents]);for(let ii=startIndex;ii<endIndex;ii++)value=data[ii].y,0<=value||context.fillRect(offsetX+ii*step,y(-value),step+1,y(0)-y(-value))}}}}render(){const{className:className,title:title,width:width,height:height}=this.props;return react_default.a.createElement("div",{className:"horizon-row ".concat(className)},react_default.a.createElement("span",{className:"title"},title),react_default.a.createElement("canvas",{ref:c=>{this.canvas=c},width:width,height:height}))}}HorizonRow_HorizonRow.displayName="HorizonRow",HorizonRow_HorizonRow.propTypes=propTypes,HorizonRow_HorizonRow.defaultProps=defaultProps,HorizonRow_HorizonRow.__docgenInfo={description:"",methods:[{name:"drawChart",docblock:null,modifiers:[],params:[],returns:null}],displayName:"HorizonRow",props:{className:{defaultValue:{value:"''",computed:!1},type:{name:"string"},required:!1,description:""},width:{defaultValue:{value:"800",computed:!1},type:{name:"number"},required:!1,description:""},height:{defaultValue:{value:"20",computed:!1},type:{name:"number"},required:!1,description:""},bands:{defaultValue:{value:"DEFAULT_COLORS.length >> 1",computed:!1},type:{name:"number"},required:!1,description:""},colors:{defaultValue:{value:"[\n  '#313695',\n  '#4575b4',\n  '#74add1',\n  '#abd9e9',\n  '#fee090',\n  '#fdae61',\n  '#f46d43',\n  '#d73027',\n]",computed:!1},type:{name:"arrayOf",value:{name:"string"}},required:!1,description:""},colorScale:{defaultValue:{value:"'series'",computed:!1},type:{name:"string"},required:!1,description:""},mode:{defaultValue:{value:"'offset'",computed:!1},type:{name:"string"},required:!1,description:""},offsetX:{defaultValue:{value:"0",computed:!1},type:{name:"number"},required:!1,description:""},title:{defaultValue:{value:"''",computed:!1},type:{name:"string"},required:!1,description:""},yDomain:{defaultValue:{value:"undefined",computed:!0},type:{name:"arrayOf",value:{name:"number"}},required:!1,description:""},data:{type:{name:"arrayOf",value:{name:"shape",value:{y:{name:"number",required:!1}}}},required:!0,description:""}}};var src_HorizonRow=HorizonRow_HorizonRow;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../plugins/legacy-plugin-chart-horizon/src/HorizonRow.jsx"]={name:"HorizonRow",docgenInfo:HorizonRow_HorizonRow.__docgenInfo,path:"../../plugins/legacy-plugin-chart-horizon/src/HorizonRow.jsx"});__webpack_require__(1603);const HorizonChart_propTypes={className:prop_types_default.a.string,width:prop_types_default.a.number,height:prop_types_default.a.number,seriesHeight:prop_types_default.a.number,data:prop_types_default.a.arrayOf(prop_types_default.a.shape({key:prop_types_default.a.arrayOf(prop_types_default.a.string),values:prop_types_default.a.arrayOf(prop_types_default.a.shape({y:prop_types_default.a.number}))})).isRequired,bands:prop_types_default.a.number,colors:prop_types_default.a.arrayOf(prop_types_default.a.string),colorScale:prop_types_default.a.string,mode:prop_types_default.a.string,offsetX:prop_types_default.a.number},HorizonChart_defaultProps={className:"",width:800,height:600,seriesHeight:20,bands:Math.floor(DEFAULT_COLORS.length/2),colors:DEFAULT_COLORS,colorScale:"series",mode:"offset",offsetX:0};class HorizonChart_HorizonChart extends react_default.a.PureComponent{render(){const{className:className,width:width,height:height,data:data,seriesHeight:seriesHeight,bands:bands,colors:colors,colorScale:colorScale,mode:mode,offsetX:offsetX}=this.props;let yDomain;if("overall"===colorScale){const allValues=data.reduce((acc,current)=>acc.concat(current.values),[]);yDomain=Object(extent.a)(allValues,d=>d.y)}return react_default.a.createElement("div",{className:"superset-legacy-chart-horizon ".concat(className),style:{height:height}},data.map(row=>react_default.a.createElement(src_HorizonRow,{key:row.key,width:width,height:seriesHeight,title:row.key.join(", "),data:row.values,bands:bands,colors:colors,colorScale:colorScale,mode:mode,offsetX:offsetX,yDomain:yDomain})))}}HorizonChart_HorizonChart.displayName="HorizonChart",HorizonChart_HorizonChart.propTypes=HorizonChart_propTypes,HorizonChart_HorizonChart.defaultProps=HorizonChart_defaultProps,HorizonChart_HorizonChart.__docgenInfo={description:"",methods:[],displayName:"HorizonChart",props:{className:{defaultValue:{value:"''",computed:!1},type:{name:"string"},required:!1,description:""},width:{defaultValue:{value:"800",computed:!1},type:{name:"number"},required:!1,description:""},height:{defaultValue:{value:"600",computed:!1},type:{name:"number"},required:!1,description:""},seriesHeight:{defaultValue:{value:"20",computed:!1},type:{name:"number"},required:!1,description:""},bands:{defaultValue:{value:"Math.floor(DEFAULT_COLORS.length / 2)",computed:!0},type:{name:"number"},required:!1,description:""},colors:{defaultValue:{value:"DEFAULT_COLORS",computed:!0},type:{name:"arrayOf",value:{name:"string"}},required:!1,description:""},colorScale:{defaultValue:{value:"'series'",computed:!1},type:{name:"string"},required:!1,description:""},mode:{defaultValue:{value:"'offset'",computed:!1},type:{name:"string"},required:!1,description:""},offsetX:{defaultValue:{value:"0",computed:!1},type:{name:"number"},required:!1,description:""},data:{type:{name:"arrayOf",value:{name:"shape",value:{key:{name:"arrayOf",value:{name:"string"},required:!1},values:{name:"arrayOf",value:{name:"shape",value:{y:{name:"number",required:!1}}},required:!1}}}},required:!0,description:""}}};__webpack_exports__.default=HorizonChart_HorizonChart;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../plugins/legacy-plugin-chart-horizon/src/HorizonChart.jsx"]={name:"HorizonChart",docgenInfo:HorizonChart_HorizonChart.__docgenInfo,path:"../../plugins/legacy-plugin-chart-horizon/src/HorizonChart.jsx"})}}]);
//# sourceMappingURL=38.bc6f8eef590607f5244d.bundle.js.map